{"version":3,"sources":["../../../../../lib/xlsx/xform/sheet/cell-xform.js"],"names":["utils","require","BaseXform","Enums","Range","RichTextXform","getValueType","v","undefined","ValueType","Null","String","Number","Boolean","Date","text","hyperlink","Hyperlink","formula","Formula","error","Error","getEffectiveCellType","cell","type","result","CellXform","richTextXForm","model","options","styleId","styles","addStyleModel","style","comment","comments","push","ref","address","sharedStrings","ssId","add","value","date1904","hyperlinks","Object","assign","target","tooltip","Merge","merges","formulae","sharedFormula","master","si","expandToAddress","siFormulae","xmlStream","attrs","t","range","leafNode","addAttribute","dateToExcel","openNode","richText","self","forEach","render","closeNode","renderFormula","node","parser","parseOpen","name","attributes","r","s","parseInt","currentNode","parseText","xmlDecode","parseFloat","parseClose","getStyleModel","getString","RichText","isDateFmt","numFmt","excelToDate","hyperlinkMap","commentsMap","module","exports"],"mappings":"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","sourcesContent":["const utils = require('../../../utils/utils');\r\nconst BaseXform = require('../base-xform');\r\n\r\nconst Enums = require('../../../doc/enums');\r\nconst Range = require('../../../doc/range');\r\n\r\nconst RichTextXform = require('../strings/rich-text-xform');\r\n\r\nfunction getValueType(v) {\r\n  if (v === null || v === undefined) {\r\n    return Enums.ValueType.Null;\r\n  }\r\n  if (v instanceof String || typeof v === 'string') {\r\n    return Enums.ValueType.String;\r\n  }\r\n  if (typeof v === 'number') {\r\n    return Enums.ValueType.Number;\r\n  }\r\n  if (typeof v === 'boolean') {\r\n    return Enums.ValueType.Boolean;\r\n  }\r\n  if (v instanceof Date) {\r\n    return Enums.ValueType.Date;\r\n  }\r\n  if (v.text && v.hyperlink) {\r\n    return Enums.ValueType.Hyperlink;\r\n  }\r\n  if (v.formula) {\r\n    return Enums.ValueType.Formula;\r\n  }\r\n  if (v.error) {\r\n    return Enums.ValueType.Error;\r\n  }\r\n  throw new Error('I could not understand type of value');\r\n}\r\n\r\nfunction getEffectiveCellType(cell) {\r\n  switch (cell.type) {\r\n    case Enums.ValueType.Formula:\r\n      return getValueType(cell.result);\r\n    default:\r\n      return cell.type;\r\n  }\r\n}\r\n\r\nclass CellXform extends BaseXform {\r\n  constructor() {\r\n    super();\r\n\r\n    this.richTextXForm = new RichTextXform();\r\n  }\r\n\r\n  get tag() {\r\n    return 'c';\r\n  }\r\n\r\n  prepare(model, options) {\r\n    const styleId = options.styles.addStyleModel(model.style || {}, getEffectiveCellType(model));\r\n    if (styleId) {\r\n      model.styleId = styleId;\r\n    }\r\n\r\n    if (model.comment) {\r\n      options.comments.push({...model.comment, ref: model.address});\r\n    }\r\n\r\n    switch (model.type) {\r\n      case Enums.ValueType.String:\r\n        if (options.sharedStrings) {\r\n          model.ssId = options.sharedStrings.add(model.value);\r\n        }\r\n        break;\r\n      case Enums.ValueType.Date:\r\n        if (options.date1904) {\r\n          model.date1904 = true;\r\n        }\r\n        break;\r\n      case Enums.ValueType.Hyperlink:\r\n        if (options.sharedStrings && model.text !== undefined && model.text !== null) {\r\n          model.ssId = options.sharedStrings.add(model.text);\r\n        }\r\n        options.hyperlinks.push(\r\n          Object.assign(\r\n            {\r\n              address: model.address,\r\n              target: model.hyperlink,\r\n            },\r\n            model.tooltip ? {tooltip: model.tooltip} : {}\r\n          )\r\n        );\r\n        break;\r\n      case Enums.ValueType.Merge:\r\n        options.merges.add(model);\r\n        break;\r\n      case Enums.ValueType.Formula:\r\n        if (options.date1904) {\r\n          // in case valueType is date\r\n          model.date1904 = true;\r\n        }\r\n        if (model.formula) {\r\n          options.formulae[model.address] = model;\r\n        } else if (model.sharedFormula) {\r\n          const master = options.formulae[model.sharedFormula];\r\n          if (!master) {\r\n            throw new Error('Shared Formula master must exist above and or left of clone');\r\n          }\r\n          if (master.si !== undefined) {\r\n            model.si = master.si;\r\n            master.ref.expandToAddress(model.address);\r\n          } else {\r\n            model.si = master.si = options.siFormulae++;\r\n            master.ref = new Range(master.address, model.address);\r\n          }\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  renderFormula(xmlStream, model) {\r\n    let attrs = null;\r\n    if (model.ref) {\r\n      attrs = {\r\n        t: 'shared',\r\n        ref: model.ref.range,\r\n        si: model.si,\r\n      };\r\n    } else if (model.si !== undefined) {\r\n      attrs = {\r\n        t: 'shared',\r\n        si: model.si,\r\n      };\r\n    }\r\n    switch (getValueType(model.result)) {\r\n      case Enums.ValueType.Null: // ?\r\n        xmlStream.leafNode('f', attrs, model.formula);\r\n        break;\r\n      case Enums.ValueType.String:\r\n        // oddly, formula results don't ever use shared strings\r\n        xmlStream.addAttribute('t', 'str');\r\n        xmlStream.leafNode('f', attrs, model.formula);\r\n        xmlStream.leafNode('v', null, model.result);\r\n        break;\r\n      case Enums.ValueType.Number:\r\n        xmlStream.leafNode('f', attrs, model.formula);\r\n        xmlStream.leafNode('v', null, model.result);\r\n        break;\r\n      case Enums.ValueType.Boolean:\r\n        xmlStream.addAttribute('t', 'b');\r\n        xmlStream.leafNode('f', attrs, model.formula);\r\n        xmlStream.leafNode('v', null, model.result ? 1 : 0);\r\n        break;\r\n      case Enums.ValueType.Error:\r\n        xmlStream.addAttribute('t', 'e');\r\n        xmlStream.leafNode('f', attrs, model.formula);\r\n        xmlStream.leafNode('v', null, model.result.error);\r\n        break;\r\n      case Enums.ValueType.Date:\r\n        xmlStream.leafNode('f', attrs, model.formula);\r\n        xmlStream.leafNode('v', null, utils.dateToExcel(model.result, model.date1904));\r\n        break;\r\n      // case Enums.ValueType.Hyperlink: // ??\r\n      // case Enums.ValueType.Formula:\r\n      default:\r\n        throw new Error('I could not understand type of value');\r\n    }\r\n  }\r\n\r\n  render(xmlStream, model) {\r\n    if (model.type === Enums.ValueType.Null && !model.styleId) {\r\n      // if null and no style, exit\r\n      return;\r\n    }\r\n\r\n    xmlStream.openNode('c');\r\n    xmlStream.addAttribute('r', model.address);\r\n\r\n    if (model.styleId) {\r\n      xmlStream.addAttribute('s', model.styleId);\r\n    }\r\n\r\n    switch (model.type) {\r\n      case Enums.ValueType.Null:\r\n        break;\r\n\r\n      case Enums.ValueType.Number:\r\n        xmlStream.leafNode('v', null, model.value);\r\n        break;\r\n\r\n      case Enums.ValueType.Boolean:\r\n        xmlStream.addAttribute('t', 'b');\r\n        xmlStream.leafNode('v', null, model.value ? '1' : '0');\r\n        break;\r\n\r\n      case Enums.ValueType.Error:\r\n        xmlStream.addAttribute('t', 'e');\r\n        xmlStream.leafNode('v', null, model.value.error);\r\n        break;\r\n\r\n      case Enums.ValueType.String:\r\n        if (model.ssId !== undefined) {\r\n          xmlStream.addAttribute('t', 's');\r\n          xmlStream.leafNode('v', null, model.ssId);\r\n        } else if (model.value && model.value.richText) {\r\n          xmlStream.addAttribute('t', 'inlineStr');\r\n          xmlStream.openNode('is');\r\n          const self = this;\r\n          model.value.richText.forEach(text => {\r\n            self.richTextXForm.render(xmlStream, text);\r\n          });\r\n          xmlStream.closeNode('is');\r\n        } else {\r\n          xmlStream.addAttribute('t', 'str');\r\n          xmlStream.leafNode('v', null, model.value);\r\n        }\r\n        break;\r\n\r\n      case Enums.ValueType.Date:\r\n        xmlStream.leafNode('v', null, utils.dateToExcel(model.value, model.date1904));\r\n        break;\r\n\r\n      case Enums.ValueType.Hyperlink:\r\n        if (model.ssId !== undefined) {\r\n          xmlStream.addAttribute('t', 's');\r\n          xmlStream.leafNode('v', null, model.ssId);\r\n        } else {\r\n          xmlStream.addAttribute('t', 'str');\r\n          xmlStream.leafNode('v', null, model.text);\r\n        }\r\n        break;\r\n\r\n      case Enums.ValueType.Formula:\r\n        this.renderFormula(xmlStream, model);\r\n        break;\r\n\r\n      case Enums.ValueType.Merge:\r\n        // nothing to add\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    }\r\n\r\n    xmlStream.closeNode(); // </c>\r\n  }\r\n\r\n  parseOpen(node) {\r\n    if (this.parser) {\r\n      this.parser.parseOpen(node);\r\n      return true;\r\n    }\r\n    switch (node.name) {\r\n      case 'c':\r\n        // const address = colCache.decodeAddress(node.attributes.r);\r\n        this.model = {\r\n          address: node.attributes.r,\r\n        };\r\n        this.t = node.attributes.t;\r\n        if (node.attributes.s) {\r\n          this.model.styleId = parseInt(node.attributes.s, 10);\r\n        }\r\n        return true;\r\n\r\n      case 'f':\r\n        this.currentNode = 'f';\r\n        this.model.si = node.attributes.si;\r\n        if (node.attributes.t === 'shared') {\r\n          this.model.sharedFormula = true;\r\n        }\r\n        this.model.ref = node.attributes.ref;\r\n        return true;\r\n\r\n      case 'v':\r\n        this.currentNode = 'v';\r\n        return true;\r\n\r\n      case 't':\r\n        this.currentNode = 't';\r\n        return true;\r\n\r\n      case 'r':\r\n        this.parser = this.richTextXForm;\r\n        this.parser.parseOpen(node);\r\n        return true;\r\n\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  parseText(text) {\r\n    if (this.parser) {\r\n      this.parser.parseText(text);\r\n      return;\r\n    }\r\n    switch (this.currentNode) {\r\n      case 'f':\r\n        this.model.formula = this.model.formula ? this.model.formula + text : text;\r\n        break;\r\n      case 'v':\r\n      case 't':\r\n        if (this.model.value && this.model.value.richText) {\r\n          this.model.value.richText.text = this.model.value.richText.text ? this.model.value.richText.text + text : text;\r\n        } else {\r\n          this.model.value = this.model.value ? this.model.value + text : text;\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  }\r\n\r\n  parseClose(name) {\r\n    switch (name) {\r\n      case 'c': {\r\n        const {model} = this;\r\n\r\n        // first guess on cell type\r\n        if (model.formula || model.sharedFormula) {\r\n          model.type = Enums.ValueType.Formula;\r\n          if (model.value) {\r\n            if (this.t === 'str') {\r\n              model.result = utils.xmlDecode(model.value);\r\n            } else if (this.t === 'b') {\r\n              model.result = parseInt(model.value, 10) !== 0;\r\n            } else if (this.t === 'e') {\r\n              model.result = {error: model.value};\r\n            } else {\r\n              model.result = parseFloat(model.value);\r\n            }\r\n            model.value = undefined;\r\n          }\r\n        } else if (model.value !== undefined) {\r\n          switch (this.t) {\r\n            case 's':\r\n              model.type = Enums.ValueType.String;\r\n              model.value = parseInt(model.value, 10);\r\n              break;\r\n            case 'str':\r\n              model.type = Enums.ValueType.String;\r\n              model.value = utils.xmlDecode(model.value);\r\n              break;\r\n            case 'inlineStr':\r\n              model.type = Enums.ValueType.String;\r\n              break;\r\n            case 'b':\r\n              model.type = Enums.ValueType.Boolean;\r\n              model.value = parseInt(model.value, 10) !== 0;\r\n              break;\r\n            case 'e':\r\n              model.type = Enums.ValueType.Error;\r\n              model.value = {error: model.value};\r\n              break;\r\n            default:\r\n              model.type = Enums.ValueType.Number;\r\n              model.value = parseFloat(model.value);\r\n              break;\r\n          }\r\n        } else if (model.styleId) {\r\n          model.type = Enums.ValueType.Null;\r\n        } else {\r\n          model.type = Enums.ValueType.Merge;\r\n        }\r\n        return false;\r\n      }\r\n\r\n      case 'f':\r\n      case 'v':\r\n      case 'is':\r\n        this.currentNode = undefined;\r\n        return true;\r\n\r\n      case 't':\r\n        if (this.parser) {\r\n          this.parser.parseClose(name);\r\n          return true;\r\n        }\r\n        this.currentNode = undefined;\r\n        return true;\r\n\r\n      case 'r':\r\n        this.model.value = this.model.value || {};\r\n        this.model.value.richText = this.model.value.richText || [];\r\n        this.model.value.richText.push(this.parser.model);\r\n        this.parser = undefined;\r\n        this.currentNode = undefined;\r\n        return true;\r\n\r\n      default:\r\n        if (this.parser) {\r\n          this.parser.parseClose(name);\r\n          return true;\r\n        }\r\n        return false;\r\n    }\r\n  }\r\n\r\n  reconcile(model, options) {\r\n    const style = model.styleId && options.styles && options.styles.getStyleModel(model.styleId);\r\n    if (style) {\r\n      model.style = style;\r\n    }\r\n    if (model.styleId !== undefined) {\r\n      model.styleId = undefined;\r\n    }\r\n\r\n    switch (model.type) {\r\n      case Enums.ValueType.String:\r\n        if (typeof model.value === 'number') {\r\n          if (options.sharedStrings) {\r\n            model.value = options.sharedStrings.getString(model.value);\r\n          }\r\n        }\r\n        if (model.value.richText) {\r\n          model.type = Enums.ValueType.RichText;\r\n        }\r\n        break;\r\n      case Enums.ValueType.Number:\r\n        if (style && utils.isDateFmt(style.numFmt)) {\r\n          model.type = Enums.ValueType.Date;\r\n          model.value = utils.excelToDate(model.value, options.date1904);\r\n        }\r\n        break;\r\n      case Enums.ValueType.Formula:\r\n        if (model.result !== undefined && style && utils.isDateFmt(style.numFmt)) {\r\n          model.result = utils.excelToDate(model.result, options.date1904);\r\n        }\r\n        if (model.sharedFormula) {\r\n          if (model.formula) {\r\n            options.formulae[model.si] = model;\r\n            delete model.sharedFormula;\r\n          } else {\r\n            model.sharedFormula = options.formulae[model.si].address;\r\n          }\r\n          delete model.si;\r\n        }\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n\r\n    // look for hyperlink\r\n    const hyperlink = options.hyperlinkMap[model.address];\r\n    if (hyperlink) {\r\n      if (model.type === Enums.ValueType.Formula) {\r\n        model.text = model.result;\r\n        model.result = undefined;\r\n      } else {\r\n        model.text = model.value;\r\n        model.value = undefined;\r\n      }\r\n      model.type = Enums.ValueType.Hyperlink;\r\n      model.hyperlink = hyperlink;\r\n    }\r\n\r\n    const comment = options.commentsMap && options.commentsMap[model.address];\r\n    if (comment) {\r\n      model.comment = comment;\r\n    }\r\n  }\r\n}\r\n\r\nmodule.exports = CellXform;\r\n"],"file":"cell-xform.js"}