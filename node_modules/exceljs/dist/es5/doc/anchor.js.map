{"version":3,"sources":["../../../lib/doc/anchor.js"],"names":["colCache","require","Anchor","worksheet","address","offset","nativeCol","nativeColOff","nativeRow","nativeRowOff","decoded","decodeAddress","col","row","Math","min","colWidth","v","floor","rowHeight","getColumn","isCustomWidth","width","getRow","height","value","model","module","exports"],"mappings":"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","sourcesContent":["'use strict';\r\n\r\nconst colCache = require('../utils/col-cache');\r\n\r\nclass Anchor {\r\n  constructor(worksheet, address, offset = 0) {\r\n    if (!address) {\r\n      this.nativeCol = 0;\r\n      this.nativeColOff = 0;\r\n      this.nativeRow = 0;\r\n      this.nativeRowOff = 0;\r\n    } else if (typeof address === 'string') {\r\n      const decoded = colCache.decodeAddress(address);\r\n      this.nativeCol = decoded.col + offset;\r\n      this.nativeColOff = 0;\r\n      this.nativeRow = decoded.row + offset;\r\n      this.nativeRowOff = 0;\r\n    } else if (address.nativeCol) {\r\n      this.nativeCol = address.nativeCol || 0;\r\n      this.nativeColOff = address.nativeColOff || 0;\r\n      this.nativeRow = address.nativeRow || 0;\r\n      this.nativeRowOff = address.nativeRowOff || 0;\r\n    } else if (address.col) {\r\n      this.col = address.col + offset;\r\n      this.row = address.row + offset;\r\n    } else {\r\n      this.nativeCol = 0;\r\n      this.nativeColOff = 0;\r\n      this.nativeRow = 0;\r\n      this.nativeRowOff = 0;\r\n    }\r\n\r\n    this.worksheet = worksheet;\r\n  }\r\n\r\n  static asInstance(model) {\r\n    return model instanceof Anchor || model == null ? model : new Anchor(model);\r\n  }\r\n\r\n  get col() {\r\n    return this.nativeCol + (Math.min(this.colWidth - 1, this.nativeColOff) / this.colWidth);\r\n  }\r\n\r\n  set col(v) {\r\n    this.nativeCol = Math.floor(v);\r\n    this.nativeColOff = Math.floor((v - this.nativeCol) * this.colWidth);\r\n  }\r\n\r\n  get row() {\r\n    return this.nativeRow + (Math.min(this.rowHeight - 1, this.nativeRowOff) / this.rowHeight);\r\n  }\r\n\r\n  set row(v) {\r\n    this.nativeRow = Math.floor(v);\r\n    this.nativeRowOff = Math.floor((v - this.nativeRow) * this.rowHeight);\r\n  }\r\n\r\n  get colWidth() {\r\n    return this.worksheet && this.worksheet.getColumn(this.nativeCol + 1) && this.worksheet.getColumn(this.nativeCol + 1).isCustomWidth\r\n      ? Math.floor(this.worksheet.getColumn(this.nativeCol + 1).width * 10000)\r\n      : 640000;\r\n  }\r\n\r\n  get rowHeight() {\r\n    return this.worksheet && this.worksheet.getRow(this.nativeRow + 1) && this.worksheet.getRow(this.nativeRow + 1).height\r\n      ? Math.floor(this.worksheet.getRow(this.nativeRow + 1).height * 10000)\r\n      : 180000;\r\n  }\r\n\r\n  get model() {\r\n    return {\r\n      nativeCol: this.nativeCol,\r\n      nativeColOff: this.nativeColOff,\r\n      nativeRow: this.nativeRow,\r\n      nativeRowOff: this.nativeRowOff,\r\n    };\r\n  }\r\n\r\n  set model(value) {\r\n    this.nativeCol = value.nativeCol;\r\n    this.nativeColOff = value.nativeColOff;\r\n    this.nativeRow = value.nativeRow;\r\n    this.nativeRowOff = value.nativeRowOff;\r\n  }\r\n}\r\n\r\nmodule.exports = Anchor;\r\n"],"file":"anchor.js"}